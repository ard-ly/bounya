[
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Quotation",
  "enabled": 1,
  "modified": "2024-10-26 12:06:20.949334",
  "module": "Albounya",
  "name": "Quotation Script",
  "script": "frappe.ui.form.on('Quotation', {\n    refresh: function(frm) {\n        if (frm.doc.docstatus === 1 && ![\"Lost\", \"Ordered\"].includes(frm.doc.status)) {\n            frm.add_custom_button(\n                __('Contract'),\n                function() {\n                    frappe.call({\n                        method: \"bounya.utils.create_contract\",\n                        args: {\n                            document: frm.doc.name,\n                            customer_name: frm.doc.customer_name\n                        },\n                        freeze: true,\n                        freeze_message: __('Creating Contract...'),\n                        callback: function(response) {\n\n                            const contract = response.message;\n                            if (contract) {\n                                frappe.set_route(\"Form\", \"Contract\", contract);\n                            }\n                        },\n                        error: function() {\n                            frappe.msgprint(__('Could not create Contract'));\n                        }\n                    });\n                },\n                __('Create')\n            );\n\n            frm.page.set_inner_btn_group_as_primary(__('Create'));\n        }\n    }\n});\n",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Employee",
  "enabled": 1,
  "modified": "2025-02-10 13:41:01.819617",
  "module": "Albounya",
  "name": "Employee Script",
  "script": "frappe.ui.form.on('Employee', {\n    refresh(frm) {\n        if(frm.doc.department){\n            frm.set_query(\"custom_section\", function() {\n                return {\n                    filters: [\n                        [\"Department\",\"is_group\", \"=\", 1],\n                        [\"Department\",\"parent_department\", \"=\", frm.doc.department]\n                    ]\n                }\n            });\n        }else{\n            frm.set_query(\"custom_section\", function() {\n                return {\n                    filters: [\n                        [\"Department\",\"name\", \"=\", 'null']\n                    ]\n                }\n            });\n        }\n\n\n        if(frm.doc.custom_section){\n            frm.set_query(\"custom_unit\", function() {\n                return {\n                    filters: [\n                        [\"Department\",\"is_group\", \"=\", 0],\n                        [\"Department\",\"parent_department\", \"=\", frm.doc.custom_section]\n                    ]\n                }\n            });\n        }else{\n            frm.set_query(\"custom_unit\", function() {\n                return {\n                    filters: [\n                        [\"Department\",\"name\", \"=\", 'null']\n                    ]\n                }\n            });\n        }\n    },\n    department(frm) {\n        frm.set_value(\"custom_section\", '')\n        frm.set_value(\"custom_unit\", '')\n\n        if(frm.doc.department){\n            frm.set_query(\"custom_section\", function() {\n                return {\n                    filters: [\n                        [\"Department\",\"is_group\", \"=\", 1],\n                        [\"Department\",\"parent_department\", \"=\", frm.doc.department]\n                    ]\n                }\n            });\n        }else{\n            frm.set_query(\"custom_section\", function() {\n                return {\n                    filters: [\n                        [\"Department\",\"name\", \"=\", 'null']\n                    ]\n                }\n            });\n        }\n    },\n    custom_section(frm) {\n        frm.set_value(\"custom_unit\", '')\n\n        if(frm.doc.custom_section){\n            frm.set_query(\"custom_unit\", function() {\n                return {\n                    filters: [\n                        [\"Department\",\"is_group\", \"=\", 0],\n                        [\"Department\",\"parent_department\", \"=\", frm.doc.custom_section]\n                    ]\n                }\n            });\n        }else{\n            frm.set_query(\"custom_unit\", function() {\n                return {\n                    filters: [\n                        [\"Department\",\"name\", \"=\", 'null']\n                    ]\n                }\n            });\n        }\n    },\n    status(frm) {\n        frm.set_value(\"custom_stop_resune\",'')\n    }\n})",
  "view": "Form"
 }
]